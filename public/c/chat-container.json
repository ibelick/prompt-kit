{
  "name": "chat-container",
  "type": "registry:ui",
  "registryDependencies": [],
  "dependencies": [],
  "devDependencies": [],
  "tailwind": {},
  "cssVars": {
    "light": {},
    "dark": {}
  },
  "description": "A component for creating chat interfaces with intelligent auto-scrolling behavior, designed to provide a smooth and responsive user experience",
  "files": [
    {
      "path": "chat-container.tsx",
      "content": "\"use client\"\n\nimport { cn } from \"@/lib/utils\"\nimport { useEffect, useRef, useState } from \"react\"\n\nconst useAutoScroll = (\n  containerRef: React.RefObject<HTMLDivElement | null>,\n  enabled: boolean\n) => {\n  const [autoScrollEnabled, setAutoScrollEnabled] = useState(true)\n  const lastScrollTopRef = useRef(0)\n  const autoScrollingRef = useRef(false)\n\n  const isAtBottom = (element: HTMLDivElement) => {\n    const { scrollTop, scrollHeight, clientHeight } = element\n    return scrollHeight - scrollTop - clientHeight <= 2\n  }\n\n  const scrollToBottom = (behavior: ScrollBehavior = \"smooth\") => {\n    const container = containerRef.current\n    if (!container) return\n\n    autoScrollingRef.current = true\n\n    const targetScrollTop = container.scrollHeight - container.clientHeight\n\n    if (behavior === \"smooth\") {\n      container.scrollTo({\n        top: targetScrollTop,\n        behavior: \"smooth\",\n      })\n\n      const checkScrollEnd = () => {\n        if (Math.abs(container.scrollTop - targetScrollTop) < 2) {\n          autoScrollingRef.current = false\n          return\n        }\n\n        requestAnimationFrame(checkScrollEnd)\n      }\n\n      requestAnimationFrame(checkScrollEnd)\n\n      const safetyTimeout = setTimeout(() => {\n        autoScrollingRef.current = false\n      }, 500)\n\n      try {\n        const handleScrollEnd = () => {\n          autoScrollingRef.current = false\n          clearTimeout(safetyTimeout)\n          container.removeEventListener(\"scrollend\", handleScrollEnd)\n        }\n\n        container.addEventListener(\"scrollend\", handleScrollEnd, {\n          once: true,\n        })\n      } catch (e) {\n        // scrollend event not supported in this browser, fallback to requestAnimationFrame\n      }\n    } else {\n      container.scrollTop = targetScrollTop\n      autoScrollingRef.current = false\n    }\n  }\n\n  useEffect(() => {\n    if (!enabled) return\n\n    const container = containerRef?.current\n    if (!container) return\n\n    lastScrollTopRef.current = container.scrollTop\n\n    const handleScroll = () => {\n      if (autoScrollingRef.current) return\n\n      const currentScrollTop = container.scrollTop\n\n      if (currentScrollTop < lastScrollTopRef.current && autoScrollEnabled) {\n        setAutoScrollEnabled(false)\n      }\n\n      if (isAtBottom(container) && !autoScrollEnabled) {\n        setAutoScrollEnabled(true)\n      }\n\n      lastScrollTopRef.current = currentScrollTop\n    }\n\n    const handleWheel = (e: WheelEvent) => {\n      if (e.deltaY < 0 && autoScrollEnabled) {\n        setAutoScrollEnabled(false)\n      }\n    }\n\n    const handleTouchStart = () => {\n      lastScrollTopRef.current = container.scrollTop\n    }\n\n    const handleTouchMove = () => {\n      if (container.scrollTop < lastScrollTopRef.current && autoScrollEnabled) {\n        setAutoScrollEnabled(false)\n      }\n\n      lastScrollTopRef.current = container.scrollTop\n    }\n\n    const handleTouchEnd = () => {\n      if (isAtBottom(container) && !autoScrollEnabled) {\n        setAutoScrollEnabled(true)\n      }\n    }\n\n    container.addEventListener(\"scroll\", handleScroll, { passive: true })\n    container.addEventListener(\"wheel\", handleWheel, { passive: true })\n    container.addEventListener(\"touchstart\", handleTouchStart, {\n      passive: true,\n    })\n    container.addEventListener(\"touchmove\", handleTouchMove, { passive: true })\n    container.addEventListener(\"touchend\", handleTouchEnd, { passive: true })\n\n    return () => {\n      container.removeEventListener(\"scroll\", handleScroll)\n      container.removeEventListener(\"wheel\", handleWheel)\n      container.removeEventListener(\"touchstart\", handleTouchStart)\n      container.removeEventListener(\"touchmove\", handleTouchMove)\n      container.removeEventListener(\"touchend\", handleTouchEnd)\n    }\n  }, [containerRef, enabled, autoScrollEnabled])\n\n  return {\n    autoScrollEnabled,\n    scrollToBottom,\n    isScrolling: autoScrollingRef.current,\n  }\n}\n\nexport type ChatContainerProps = {\n  children: React.ReactNode\n  className?: string\n  autoScroll?: boolean\n  scrollToRef?: React.RefObject<HTMLDivElement | null>\n  ref?: React.RefObject<HTMLDivElement | null>\n} & React.HTMLAttributes<HTMLDivElement>\n\nfunction ChatContainer({\n  className,\n  children,\n  autoScroll = true,\n  scrollToRef,\n  ref,\n  ...props\n}: ChatContainerProps) {\n  const containerRef = useRef<HTMLDivElement>(null)\n  const localBottomRef = useRef<HTMLDivElement>(null)\n  const bottomRef = scrollToRef || localBottomRef\n  const chatContainerRef = ref || containerRef\n\n  const { autoScrollEnabled, scrollToBottom, isScrolling } = useAutoScroll(\n    chatContainerRef,\n    autoScroll\n  )\n\n  useEffect(() => {\n    if (autoScroll && autoScrollEnabled && !isScrolling) {\n      requestAnimationFrame(() => {\n        scrollToBottom(\"smooth\")\n      })\n    }\n  }, [children, autoScroll, autoScrollEnabled, isScrolling, scrollToBottom])\n\n  return (\n    <div\n      className={cn(\"flex flex-col overflow-y-auto\", className)}\n      role=\"log\"\n      ref={chatContainerRef}\n      {...props}\n    >\n      {children}\n      <div\n        ref={bottomRef}\n        className=\"h-[1px] w-full flex-shrink-0 scroll-mt-4\"\n        aria-hidden=\"true\"\n      />\n    </div>\n  )\n}\n\nexport { ChatContainer }\n",
      "type": "registry:ui"
    }
  ]
}